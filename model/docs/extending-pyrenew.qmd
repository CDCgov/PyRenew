---
title: Extending pyrenew
format: gfm
---

```{python}
import jax
import jax.numpy as jnp
import matplotlib.pyplot as plt
import numpy as np
import numpyro as npro
import numpyro.distributions as dist
import polars as pl
import pytest
from pyrenew.deterministic import DeterministicPMF, NullObservation
from pyrenew.latent import Infections0, InfectionsRtFeedback
from pyrenew.model import RtInfectionsRenewalModel
from pyrenew.observation import PoissonObservation
from pyrenew.process import RtRandomWalkProcess

gen_int = DeterministicPMF(jnp.array([0.25, 0.25, 0.25, 0.25]))

I0 = Infections0(I0_dist=dist.LogNormal(0, 1))

latent_infections = InfectionsRtFeedback(
  infection_feedback_strength = gen_int,
  infection_feedback_pmf = gen_int,
)

rt = RtRandomWalkProcess()

model0 = RtInfectionsRenewalModel(
    gen_int=gen_int,
    I0=I0,
    latent_infections=latent_infections,
    Rt_process=rt,
    # Explicitly use None, this should call the NullObservation
    observation_process=None,
)

# Sampling and fitting model 0 (with no obs for infections)
np.random.seed(223)
with npro.handlers.seed(rng_seed=np.random.randint(1, 600)):
    model0_samp = model0.sample(n_timepoints=30)
```
